<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Staff Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">

    <div class="d-flex justify-content-end mb-3">
      <a href="/logout" class="btn btn-danger">Logout</a>
    </div>

    <!-- Welcome -->
    <h1>Welcome, <%= user.username %> (Staff)</h1>
    <hr>

    <!-- Events Table -->
    <h2>Events</h2>
    <table class="table table-bordered mt-3">
      <thead class="table-dark">
        <tr>
          <th>Title</th>
          <th>Date</th>
          <th>Seats</th>
          <th>Price</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% events.forEach(event => { %>
          <tr class="<%= event.status === 'canceled' ? 'table-danger' : '' %>">
            <td><%= event.title %></td>
            <td><%= event.date.toDateString() %></td>
            <td><%= event.totalSeats %></td>
            <td>â‚¹<%= event.price %></td>
            <td>
              <% if(event.status === 'active'){ %>
                <span class="badge bg-success">Active</span>
              <% } else { %>
                <span class="badge bg-danger">Canceled</span>
              <% } %>
            </td>
            <td>
              <% if(event.status === 'active'){ %>
                <!-- Cancel event -->
                <form action="/staff/events/<%= event._id %>/cancel?_method=PUT" method="POST" style="display:inline;">
                  <button type="submit" class="btn btn-sm btn-warning">Cancel</button>
                </form>
              <% } else { %>
                <!-- Reactivate event -->
                <form action="/staff/events/<%= event._id %>/activate?_method=PUT" method="POST" style="display:inline;">
                  <button type="submit" class="btn btn-sm btn-success">Reactivate</button>
                </form>
              <% } %>

              <!-- View event details -->
              <a href="/staff/events/<%= event._id %>" class="btn btn-sm btn-secondary">View</a>

              <!-- View attendees -->
              <a href="/staff/events/<%= event._id %>/attendees" class="btn btn-sm btn-info">View Attendees</a>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
